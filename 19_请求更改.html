<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="vue.js"></script>
    <!-- 引入axios-->
    <script src="axios.js"></script>
</head>
<body>
    <div id="app">

    </div>

    <script>
        /**
            先在根目录下执行命令：node server.js
            开启服务端程序，成功，则打印 '服务器启动在8888端口'         
         */

        // 将axios绑定到Vue对象上
        Vue.prototype.$axios = axios;

        // 根组件
        var App = {
            template: `
            <div>
                <button @click='doGet'>get请求</button>
                <button @click='doPost'>post请求</button>
                <div id='data'>

                </div>
            </div>
            `,
            created() {
                this.$axios.defaults.baseURL = 'http://127.0.0.1:8888/'
            },
            methods: {
                doGet() {
                    
                    this.$axios.get('', {
                        params: {id: 1},
                        transformResponse: [function(data) { // 修改response
                            console.log(data);
                        }]
                    })
                    .then(res => {
                        document.querySelector('#data').innerHTML = "succss: <br>" + JSON.stringify(res);
                        // console.log(res);
                    })
                    .catch(err => {
                        document.querySelector('#data').innerHTML = "error: <br>" + err;
                        // console.log(err);
                    })
                },

                doPost() {
                    this.$axios.post('/test', {
                        id: 1   
                    }, {
                        transformRequest: [function(data) { // 修改request
                            data = {
                                id: data.id,
                                name: 'zhangsan'
                            }
                            console.log(data);
                            return data;
                        }]
                    })
                }
            }
        }

        new Vue({
            el: '#app',
            template:`<App />`,
            data: function() {
                return {

                }
            },
            methods: {
                
            },
            components: {
                App
            }
        })
    </script>
</body>
</html>